<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Join Tournament | Tournament Sa Kamao</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:linear-gradient(180deg,#020617,#0f172a);
  color:#fff;
}
.header{
  padding:16px;
  text-align:center;
  font-size:22px;
  font-weight:bold;
}
.back{
  margin:12px 16px;
  color:#38bdf8;
  font-size:14px;
  cursor:pointer;
}
.card{
  background:#020617;
  margin:14px;
  padding:16px;
  border-radius:14px;
}
.card h3{margin:0 0 6px}
.card p{margin:4px 0;font-size:14px;opacity:.9}
.join-btn{
  margin-top:10px;
  padding:12px;
  width:100%;
  border:none;
  border-radius:10px;
  background:#22c55e;
  color:#000;
  font-weight:bold;
  font-size:15px;
}
.loading{
  text-align:center;
  margin:40px;
  opacity:.8;
}
</style>
</head>

<body>

<div class="header">Join Tournament</div>
<div class="back" onclick="location.href='index.html'">← Back</div>

<div id="tournament-list">
  <div class="loading">Loading tournaments...</div>
</div>

<script>
const SHEET_ID = "1Jf-LmbUP1z7YPCE01dy3TKe6PKR3lw2qDEenp-2uLjA";
const TOURNAMENTS_URL =
  `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=Tournaments`;

fetch(TOURNAMENTS_URL)
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split("\n").slice(1);
    const container = document.getElementById("tournament-list");
    container.innerHTML = "";

    rows.forEach(row => {
      const c = row.split(",");
      const status = (c[7] || "").trim(); // status

      if (status === "ON") {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <h3>${c[2]}</h3>
          <p><b>Game:</b> ${c[1]}</p>
          <p><b>Prize:</b> ₹${c[3]}</p>
          <p><b>Entry Fee:</b> ₹${c[4]}</p>
          <p><b>Date:</b> ${c[5]} | ${c[6]}</p>
          <button class="join-btn" onclick="location.href='details.html'">JOIN NOW</button>
        `;
        container.appendChild(card);
      }
    });

    if (container.innerHTML === "") {
      container.innerHTML = "<div class='loading'>No active tournaments</div>";
    }
  })
  .catch(() => {
    document.getElementById("tournament-list").innerHTML =
      "<div class='loading'>Failed to load tournaments</div>";
  });
</script>

</body>
</html>
